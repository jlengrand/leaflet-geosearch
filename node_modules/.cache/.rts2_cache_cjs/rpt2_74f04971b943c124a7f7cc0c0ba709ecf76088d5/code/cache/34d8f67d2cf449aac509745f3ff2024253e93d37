{"code":"import { createElement, addClassName, removeClassName, cx, stopPropagation, replaceClassName, } from './domUtils';\r\nimport { ESCAPE_KEY, ENTER_KEY } from './constants';\r\nexport default class SearchElement {\r\n    constructor({ handleSubmit, searchLabel, classNames = {}, }) {\r\n        this.hasError = false;\r\n        this.container = createElement('div', cx('geosearch', classNames.container));\r\n        this.form = createElement('form', ['', classNames.form].join(' '), this.container, {\r\n            autocomplete: 'none',\r\n            onClick: stopPropagation,\r\n            onDblClick: stopPropagation,\r\n            touchStart: stopPropagation,\r\n            touchEnd: stopPropagation,\r\n        });\r\n        this.input = createElement('input', ['glass', classNames.input].join(' '), this.form, {\r\n            type: 'text',\r\n            placeholder: searchLabel || 'search',\r\n            onInput: this.onInput,\r\n            onKeyUp: (e) => this.onKeyUp(e),\r\n            onKeyPress: (e) => this.onKeyPress(e),\r\n            onFocus: this.onFocus,\r\n            onBlur: this.onBlur,\r\n            // For some reason, leaflet is blocking the 'touchstart', manually give\r\n            // focus to the input onClick\r\n            // > Ignored attempt to cancel a touchstart event with cancelable=false,\r\n            // > for example because scrolling is in progress and cannot be interrupted.\r\n            onClick: () => {\r\n                this.input.focus();\r\n                this.input.dispatchEvent(new Event('focus'));\r\n            },\r\n        });\r\n        this.handleSubmit = handleSubmit;\r\n    }\r\n    onFocus() {\r\n        addClassName(this.form, 'active');\r\n    }\r\n    onBlur() {\r\n        removeClassName(this.form, 'active');\r\n    }\r\n    async onSubmit(event) {\r\n        stopPropagation(event);\r\n        replaceClassName(this.container, 'error', 'pending');\r\n        await this.handleSubmit({ query: this.input.value });\r\n        removeClassName(this.container, 'pending');\r\n    }\r\n    onInput() {\r\n        if (!this.hasError) {\r\n            return;\r\n        }\r\n        removeClassName(this.container, 'error');\r\n        this.hasError = false;\r\n    }\r\n    onKeyUp(event) {\r\n        if (event.keyCode !== ESCAPE_KEY) {\r\n            return;\r\n        }\r\n        removeClassName(this.container, ['pending', 'active']);\r\n        this.input.value = '';\r\n        document.body.focus();\r\n        document.body.blur();\r\n    }\r\n    onKeyPress(event) {\r\n        if (event.keyCode !== ENTER_KEY) {\r\n            return;\r\n        }\r\n        this.onSubmit(event);\r\n    }\r\n    setQuery(query) {\r\n        this.input.value = query;\r\n    }\r\n}\r\n//# sourceMappingURL=SearchElement.js.map","references":["/Users/julienlengrand-lambert/Developer/leaflet-geosearch/src/domUtils.ts","/Users/julienlengrand-lambert/Developer/leaflet-geosearch/src/constants.ts"],"map":"{\"version\":3,\"file\":\"SearchElement.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/SearchElement.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/julienlengrand-lambert/Developer/leaflet-geosearch/SearchElement.d.ts","writeByteOrderMark":false,"text":"interface SearchElementProps {\r\n    searchLabel?: string;\r\n    handleSubmit: (args: {\r\n        query: string;\r\n    }) => void;\r\n    classNames?: {\r\n        container?: string;\r\n        form?: string;\r\n        input?: string;\r\n    };\r\n}\r\nexport default class SearchElement {\r\n    container: HTMLDivElement;\r\n    form: HTMLFormElement;\r\n    input: HTMLInputElement;\r\n    handleSubmit: (args: {\r\n        query: string;\r\n    }) => void;\r\n    hasError: boolean;\r\n    constructor({ handleSubmit, searchLabel, classNames, }: SearchElementProps);\r\n    onFocus(): void;\r\n    onBlur(): void;\r\n    onSubmit(event: Event): Promise<void>;\r\n    onInput(): void;\r\n    onKeyUp(event: KeyboardEvent): void;\r\n    onKeyPress(event: KeyboardEvent): void;\r\n    setQuery(query: string): void;\r\n}\r\nexport {};\r\n"}}
